# A. –°—É–º–º–∞ –ø—Ä–æ—Å—Ç–∞—è

|                                |                   |
| ------------------------------ | ----------------- |
| –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ç–µ—Å—Ç | 1 —Å–µ–∫—É–Ω–¥–∞         |
| –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –ø–∞–º—è—Ç–∏ –Ω–∞ —Ç–µ—Å—Ç  | 512 –º–µ–≥–∞–±–∞–π—Ç      |
| –≤–≤–æ–¥                           | —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–≤–æ–¥  |
| –≤—ã–≤–æ–¥                          | —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ |

–í–∞–º –Ω—É–∂–Ω–æ –Ω–∞—É—á–∏—Ç—å—Å—è –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å ¬´—Å—É–º–º–∞ —á–∏—Å–µ–ª –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ¬ª.

–ú–∞—Å—Å–∏–≤ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è. –ó–∞–ø—Ä–æ—Å–æ–≤ –º–Ω–æ–≥–æ. –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å–ª–µ–¥—É–µ—Ç –∑–∞ $O(1)$.

## –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ ‚Äî $n$ –∏ —á–∏—Å–ª–∞ $x$, $y$, $a_0$, –ø–æ—Ä–æ–∂–¥–∞—é—â–∏–µ –º–∞—Å—Å–∏–≤ $a$: $a_i=(x \cdot a_{i‚àí1} + y) \mod 2^{16}$
–î–∞–ª–µ–µ —Å–ª–µ–¥—É–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ $m$ –∏ —á–∏—Å–ª–∞ $z$, $t$, $b_0$, –ø–æ—Ä–æ–∂–¥–∞—é—â–∏–µ –º–∞—Å—Å–∏–≤ $b$: $b_i=(z \cdot b_{i‚àí1} + t) \mod 2^{30}$.

–ú–∞—Å—Å–∏–≤ $c$ —Å—Ç—Ä–æ–∏—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: $c_i = b_i \mod n$.

–ó–∞–ø—Ä–æ—Å—ã: $i$-–π –∏–∑ –Ω–∏—Ö ‚Äî –Ω–∞–π—Ç–∏ —Å—É–º–º—É –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –æ—Ç $\min(c_{2i}, c_{2i+1})$ –¥–æ $\max(c_{2i}, c_{2i+1})$ –≤ –º–∞—Å—Å–∏–≤–µ $a$.

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: $1 \leq n \leq 10^7$, $0 \leq m \leq 10^7$. –í—Å–µ —á–∏—Å–ª–∞ —Ü–µ–ª—ã–µ –æ—Ç $0$ –¥–æ $2^{16}$. $t$ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–≤–Ω–æ $‚àí1$.

## –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–í—ã–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤—Å–µ—Ö —Å—É–º–º.

### –ü—Ä–∏–º–µ—Ä
–≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```
3 1 2 3
3 1 -1 4
```
–≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```
23
```

### –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
$a = \\{ 3, 5, 7 \\}$, $b = \\{ 4, 3, 2, 1, 0, 2^{30}‚àí1 \\}$, $c = \\{ 1, 0, 2, 1, 0, 0 \\}$,

–∑–∞–ø—Ä–æ—Å—ã $= \\{ [0,1], [1,2], [0,0] \\}$, —Å—É–º–º—ã $= \\{ 8, 12, 3 \\}$.




# B. –†–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

|                                |                   |
| ------------------------------ | ----------------- |
| –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ç–µ—Å—Ç | 2 —Å–µ–∫—É–Ω–¥—ã         |
| –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –ø–∞–º—è—Ç–∏ –Ω–∞ —Ç–µ—Å—Ç  | 512 –º–µ–≥–∞–±–∞–π—Ç      |
| –≤–≤–æ–¥                           | —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–≤–æ–¥  |
| –≤—ã–≤–æ–¥                          | —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ |

–î–∞–Ω –º–∞—Å—Å–∏–≤ –∏–∑ $n$ —á–∏—Å–µ–ª. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–∞: –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º—É–º –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –º–µ–∂–¥—É $u$ –∏ $v$ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ.

## –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –∑–¥–∞–Ω—ã —Ç—Ä–∏ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã—Ö —á–∏—Å–ª–∞ $n$, $m$ ( $1 \leq n \leq 10^5$, $1 \leq m \leq 10^7$ ) –∏ $a_1$ ( $0 \leq a_1 < 16714589$ ) ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã—Ö —á–∏—Å–ª–∞ $u_1$ –∏ $v_1$ ( $1 \leq u_1$, $v_1 \leq n$ ) ‚Äî –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å.

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Ä–∞–∑–º–µ—Ä –≤–≤–æ–¥–∞ –±—ã–ª –Ω–µ–±–æ–ª—å—à–æ–π, –º–∞—Å—Å–∏–≤ –∏ –∑–∞–ø—Ä–æ—Å—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è.

–≠–ª–µ–º–µ–Ω—Ç—ã $a_2, a_3, \ldots, a_n$ –∑–∞–¥–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–π —Ñ–æ—Ä–º—É–ª–æ–π:
$a_{i+1}=(23 \cdot a_i + 21563) \mod 16714589$.
–ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ $n = 10$, $a_1 = 12345$ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π –º–∞—Å—Å–∏–≤: $a = (12345, 305498, 7048017, 11694653, 1565158, 2591019, 9471233, 570265, 13137658, 1325095)$.

–ó–∞–ø—Ä–æ—Å—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

$u_{i+1} = ((17 \cdot u_i + 751 + r_i + 2 \cdot i) \mod n) + 1$, $v_{i+1} = ((13 \cdot v_i + 593 + r_i +5 \cdot i) \mod n) + 1$,

–≥–¥–µ $r_i$ ‚Äî –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å –Ω–æ–º–µ—Ä $i$.
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ $u_i$ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ, —á–µ–º $v_i$.

## –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–í –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª –≤—ã–≤–µ–¥–∏—Ç–µ $u_m$, $v_m$ –∏ $r_m$ (–ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—Ä–æ—Å –∏ –æ—Ç–≤–µ—Ç –Ω–∞ –Ω–µ–≥–æ).

### –ü—Ä–∏–º–µ—Ä
–≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```
10 8 12345
3 9
```
–≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```
5 3 1565158
```

### –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
–ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –º–∞—Å—Å–∏–≤—ã ùë¢, ùë£ –∏ ùëü –º–æ–∂–Ω–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –ø–∞–º—è—Ç–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é.

–ó–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –Ω–∏—Ö –≤—ã–≥–ª—è–¥—è—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

| $i$ | $u_i$ | $v_i$ | $r_i$   |
|-----|-------|-------|---------|
| 1   | 3     | 9     | 570265  |
| 2   | 10    | 1     | 12345   |
| 3   | 1     | 2     | 12345   |
| 4   | 10    | 10    | 1325095 |
| 5   | 5     | 9     | 570265  |
| 6   | 2     | 1     | 12345   |
| 7   | 3     | 2     | 305498  |
| 8   | 5     | 3     | 1565158 |
